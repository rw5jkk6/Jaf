## ポートスキャンまでは同じ
- 自分のIPアドレスを調べる
  - ip a は ip addres showの略
  - -4 はIPv4だけを出力している 
```
ip a
ip address show
ip -4 addr show dev enp0s3
ifcofig
``` 
- ターゲットのIPアドレスを調べる
  - ターゲットが出てこない時があるのでいろいろ試してみる
  - arp-scanは自身のipアドレスが出てこない気がする
  - fpingの-aは起動している端末全て表示、-rは失敗した時のリトライ回数、-gはアドレスを帯域で指定

```
sudo arp-scan  --localnet
ip neigh
```
- arpプロトコルを使う
```
sudo fping -aqg 192.168.56.0/24
sudo fping -a -r 0 -g 192.168.56.0/24
sudo nmap -sn 192.168.56.0/24
sudo netenum  192.168.56.0/24 5 1
```
- pingのicmpプロトコルを使う
- ターゲットのIPアドレスを環境変数に登録する
- 今回使うディレクトリをホームの下に作って移動する
- ポートスキャンをする

### nmapの使い方
- 初めに全ポートを探索
  - `sudo nmap -p- $IP`

- 次に見つかったポートだけ詳細に調べて、記録する
  - `sudo nmap -p ?,? -A $IP | tee nmap.log` 

- nmapのメモ
  - sshの22ポートがfilteredやサイトのポートが無ければポートノッキングを疑う
  - openしているポートを順に攻めていく(ftpなど)
  - サービスのバージョンが表示されていれば、searchsploitで脆弱性がないか調べてみる
  - シングルクォーテーションだとIPは変数として使えないのでダブルクォーテーションに囲む
  - (UDP)sudo nmap -sU -p 1-100 IPアドレス
    - 時間が掛かるのでポートの指定を工夫する

### CMSか否か
- `nikto -url $IP`

### サイトの探索
- 何のサイトか 
- 入力欄があるか
- fileのアップロードがあるか
- URIにクエリがあるか
- robots.txtまたはコメントを見る

### gobusterで隠しサイトを探す
- 辞書の設定でいろいろな辞書があるが、だいたいよく使うのを環境変数として登録してしまう
- `dirsmall`はディレクトリの単語の少ない用の辞書って意味
- 次のを`~/.bashrc`に書き込む
```
#Dictionary of gobuster
export dirsmall=/usr/share/wordlists/dirb/common.txt
export dirmedium=/usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
export dirbig=/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

- 利用の際には環境変数なので$をつけて使う
  - `gobuster dir -u $IP -w $dirmedium`

- それでも特に見つからない場合
  - 拡張子をつけてみる (例) `-x php,txt,html`
  - gobusterで見つかったサイトをさらにgobusterする 
